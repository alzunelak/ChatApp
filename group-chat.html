<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Group Chat</title>
<style>
body{font-family:Arial;margin:0;padding:0;background:#f5f5f5;display:flex;flex-direction:column;height:100vh;}
header{background:#25d366;color:white;padding:10px;display:flex;flex-direction:column;}
#chatArea{flex:1;padding:10px;overflow-y:auto;}
.message{background:white;padding:8px 12px;margin:5px 0;border-radius:8px;max-width:70%;}
.message.self{background:#dcf8c6;align-self:flex-end;}
#inputArea{display:flex;padding:10px;background:#fff;}
#inputArea input{flex:1;padding:10px;border-radius:20px;border:1px solid #ccc;}
#inputArea button{margin-left:5px;padding:10px 15px;border:none;border-radius:20px;background:#25d366;color:white;cursor:pointer;}
</style>
</head>
<body>

<header>
  <h2 id="groupName">Group</h2>
</header>

<div id="chatArea"></div>

<div id="inputArea">
  <input type="text" id="msgInput" placeholder="Type a message...">
  <button onclick="sendMessage()">Send</button>
</div>

<script>
// User info
const myName = localStorage.getItem("username") || "You";
let currentGroup = JSON.parse(localStorage.getItem("currentGroup") || '{"name":"Group","members":[],"id":"group_default"}');
document.getElementById("groupName").innerText = currentGroup.name;

// Messages
let messages = JSON.parse(localStorage.getItem("groupMessages_"+currentGroup.id) || "[]");
const chatArea = document.getElementById("chatArea");
function saveMessages(){ localStorage.setItem("groupMessages_"+currentGroup.id, JSON.stringify(messages)); }
function renderMessages(){
  chatArea.innerHTML="";
  messages.forEach(m=>{
    const div = document.createElement("div");
    div.className="message" + (m.sender===myName?" self":"");
    div.innerHTML=`<strong>${m.sender}</strong>: ${m.text}`;
    chatArea.appendChild(div);
  });
  chatArea.scrollTop = chatArea.scrollHeight;
}
renderMessages();

// Send message
function sendMessage(){
  const input = document.getElementById("msgInput");
  const text = input.value.trim();
  if(!text) return;
  const msg={sender:myName,text,time:new Date().toLocaleTimeString()};
  messages.push(msg);
  saveMessages();
  renderMessages();
  input.value="";
}
</script>

</body>
</html>
