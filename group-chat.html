
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Group Chat</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f2f2f2;}
header{background:#25d366;color:white;padding:10px;text-align:center;display:flex;align-items:center;justify-content:space-between;}
header h2{margin:0;}
header button{padding:5px 10px;border:none;border-radius:5px;background:white;color:#25d366;cursor:pointer;}
#chatWindow{display:flex;flex-direction: column;height:80vh;background:#fff;margin:10px;border-radius:10px;overflow:hidden;}
#messages{flex:1;padding:10px;overflow-y:auto;}
.message{margin:5px 0;padding:5px 10px;border-radius:10px;max-width:80%;}
.sent{background:#25d366;color:white;margin-left:auto;}
.received{background:#eee;margin-right:auto;}
#inputArea{display:flex;padding:5px;border-top:1px solid #ccc;}
#inputArea input{flex:1;padding:5px;}
#inputArea button{padding:5px 10px;margin-left:5px;background:#25d366;color:white;border:none;border-radius:5px;cursor:pointer;}
nav{position:fixed;bottom:0;left:0;width:100%;background:white;display:flex;justify-content:space-around;border-top:1px solid #ccc;}
nav a{text-align:center;padding:10px;flex:1;color:#555;text-decoration:none;font-size:14px;}
nav a.active{color:#25d366;}
</style>
</head>
<body>

<header>
  <h2 id="group-name">Group Name</h2>
  <button onclick="goBack()">Back</button>
</header>

<div id="chatWindow">
  <div id="messages"></div>
  <div id="inputArea">
    <input type="text" id="chatInput" placeholder="Type a message">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<nav>
  <a href="home.html">Chats</a>
  <a href="groups.html" class="active">Groups</a>
  <a href="calls.html">Calls</a>
</nav>

<script>
// Load group
let group = JSON.parse(localStorage.getItem("currentGroup"));
if(!group){ alert("No group selected"); window.location.href="groups.html"; }
document.getElementById("group-name").innerText = group.name;

// User info
let username = localStorage.getItem("username");
let userId = localStorage.getItem("userId");

// Load messages
function loadMessages(){
  const messagesDiv = document.getElementById("messages");
  const msgs = JSON.parse(localStorage.getItem("group_"+group.id)||"[]");
  messagesDiv.innerHTML="";
  msgs.forEach(m=>{
    const div = document.createElement("div");
    div.className = "message "+(m.senderId===userId?"sent":"received");
    div.innerText = m.senderName+": "+m.text;
    messagesDiv.appendChild(div);
  });
  messagesDiv.scrollTop = messagesDiv.scrollHeight;
}
loadMessages();

// Send message
function sendMessage(){
  const input = document.getElementById("chatInput");
  const text = input.value.trim();
  if(!text) return;
  const key = "group_"+group.id;
  const msgs = JSON.parse(localStorage.getItem(key)||"[]");
  msgs.push({senderId:userId, senderName:username, text});
  localStorage.setItem(key, JSON.stringify(msgs));
  input.value="";
  loadMessages();
}

// Back
function goBack(){ window.location.href="groups.html"; }

</script>
</body>
</html>
