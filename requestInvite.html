<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Request / Invite</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
body { 
    font-family:'Segoe UI',Arial,sans-serif; 
    background:#000; 
    color:#fff; 
    padding:20px; 
}
h2 { text-align:center; }
.item { 
    padding:10px; 
    border-bottom:1px solid #333; 
    display:flex; 
    justify-content:space-between; 
    align-items:center; 
}
.item button { 
    margin-left:5px; 
    padding:5px 10px; 
    border:none; 
    border-radius:5px; 
    cursor:pointer; 
    color:#fff; 
}
.acceptBtn { background:#25D366; }
.rejectBtn { background:#FF3B30; }
.backBtn { 
    margin-bottom:10px; 
    cursor:pointer; 
    color:#00bfa5; 
    font-size:16px; 
    display:inline-flex; 
    align-items:center; 
    gap:5px; 
}
p { color:#aaa; font-style:italic; }
    
    </style>
<script>
// ===== DEFAULT DATA =====
const defaultRequests = ["Charlie", "David"];
const defaultMembers = ["John Doe", "Alice", "Bob"];

// ===== STATE =====
let requests;
let groupMembers;

// ===== INIT FUNCTION =====
function initData() {
    try {
        requests = JSON.parse(localStorage.getItem("groupRequests"));
        if (!Array.isArray(requests) || requests.length === 0) requests = [...defaultRequests];
    } catch {
        requests = [...defaultRequests];
    }

    try {
        groupMembers = JSON.parse(localStorage.getItem("groupMembers"));
        if (!Array.isArray(groupMembers)) groupMembers = [...defaultMembers];
    } catch {
        groupMembers = [...defaultMembers];
    }

    // Save back to localStorage if empty or invalid
    localStorage.setItem("groupRequests", JSON.stringify(requests));
    localStorage.setItem("groupMembers", JSON.stringify(groupMembers));
}

// ===== RENDER FUNCTION =====
function renderRequests() {
    const listDiv = document.getElementById("requestList");
    listDiv.innerHTML = "";

    if (requests.length === 0) {
        listDiv.innerHTML = "<p>No requests</p>";
        return;
    }

    requests.forEach((r, index) => {
        const div = document.createElement("div");
        div.className = "item";

        const nameSpan = document.createElement("span");
        nameSpan.textContent = r;

        const acceptBtn = document.createElement("button");
        acceptBtn.className = "acceptBtn";
        acceptBtn.textContent = "Accept";
        acceptBtn.onclick = () => {
            if (!groupMembers.includes(r)) groupMembers.push(r);
            requests.splice(index, 1);

            localStorage.setItem("groupMembers", JSON.stringify(groupMembers));
            localStorage.setItem("groupRequests", JSON.stringify(requests));
            renderRequests();
            alert(r + " added to the group!");
        };

        const rejectBtn = document.createElement("button");
        rejectBtn.className = "rejectBtn";
        rejectBtn.textContent = "Reject";
        rejectBtn.onclick = () => {
            requests.splice(index, 1);
            localStorage.setItem("groupRequests", JSON.stringify(requests));
            renderRequests();
        };

        div.appendChild(nameSpan);
        div.appendChild(acceptBtn);
        div.appendChild(rejectBtn);
        listDiv.appendChild(div);
    });
}

// ===== BACK BUTTON =====
function goBack() {
    window.history.back();
}

// ===== INIT PAGE =====
window.onload = function() {
    initData();
    renderRequests();
};
</script>
</body>
</html>
