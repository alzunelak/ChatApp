<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GazaChat App</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body{margin:0;font-family:'Segoe UI',Arial,sans-serif;background:#fff;height:100vh;display:flex;flex-direction:column;}
#chatPage,#friendInfoPage{display:flex;flex-direction:column;flex:1;}
.header{display:flex;align-items:center;justify-content:space-between;background:#128C7E;padding:10px;border-bottom:1px solid #ccc;position:relative;}
.header img{width:50px;height:50px;border-radius:50%;cursor:pointer;object-fit:cover;}
.header-info{flex:1;display:flex;flex-direction:column;margin-left:10px;overflow:hidden;}
.header-info h2{margin:0;font-size:16px;cursor:pointer;}
.header-actions{display:flex;align-items:center;gap:15px;}
.header-actions button{background:none;border:none;cursor:pointer;font-size:20px;color:white;}
#chatBox{flex:1;overflow-y:auto;padding:10px;margin-bottom:100px;display:flex;flex-direction:column;gap:6px;}
.msg{max-width:70%;padding:10px 14px;border-radius:18px;background:#f1f1f1;align-self:flex-start;word-break:break-word;}
.msg.self{background:#dcf8c6;align-self:flex-end;}
.msg .meta{display:block;margin-top:4px;font-size:10px;color:#999;text-align:right;}
.msg.system{background:#e1f0ff;color:#333;align-self:center;text-align:center;}
#inputArea{display:flex;align-items:center;position:fixed;bottom:10px;left:10px;width:calc(100% - 20px);z-index:100;}
.input-box{display:flex;flex:1;background:#f1f1f1;border-radius:25px;padding:6px 10px;gap:6px;}
.input-box input{flex:1;border:none;outline:none;font-size:14px;background:transparent;}
.input-buttons button{background:transparent;border:none;font-size:20px;cursor:pointer;color:#128C7E;}
#micBtn{width:40px;height:40px;border-radius:50%;background:#25D366;color:white;border:none;font-size:18px;display:flex;align-items:center;justify-content:center;margin-left:6px;}
.popup{display:none;position:absolute;top:50px;right:10px;background:#fff;border:1px solid #ccc;border-radius:8px;z-index:1000;width:150px;}
.popup div{padding:10px;cursor:pointer;border-bottom:1px solid #eee;}
.popup div:hover{background:#f1f1f1;}
#emojiPicker{position:absolute;bottom:60px;left:10px;background:#fff;border:1px solid #ccc;padding:10px;display:none;max-height:200px;overflow-y:auto;border-radius:8px;}
#emojiPicker span{font-size:20px;padding:5px;cursor:pointer;}
#emojiPicker span:hover{background:#eee;border-radius:5px;}
#attachPopup{display:none;position:absolute;bottom:60px;left:60px;background:#fff;border:1px solid #ccc;border-radius:12px;padding:12px;width:270px;box-shadow:0 6px 18px rgba(0,0,0,0.2);z-index:2000;}
#attachGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
.attachItem{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:10px;border-radius:10px;cursor:pointer;background:#f8f8f8;border:1px solid #eee;text-align:center;font-size:12px;user-select:none;}
.attachItem:hover{background:#f1f1f1;}
.attachItem i{font-size:20px;color:#075E54;}
.attachItem input{display:none;}
#friendInfoPage{display:none;flex-direction:column;padding:20px;background:#f5f5f5;}
.friendHeader{text-align:center;margin-bottom:20px;position:relative;}
.friendHeader img{width:120px;height:120px;border-radius:50%;margin-bottom:10px;object-fit:cover;}
.friendHeader h2{margin:0;font-size:22px;margin-bottom:20px;}
.actionButtons{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px;width:100%;}
.actionButtons button{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10px 0;background:#fff;border:1px solid #eee;border-radius:8px;cursor:pointer;}
.actionButtons i{font-size:20px;margin-bottom:5px;}
.settingsContainer{display:flex;flex-direction:column;gap:8px;padding:10px;border-top:1px solid #ccc;border-bottom:1px solid #ccc;background:#fff;border-radius:8px;margin-bottom:15px;}
.settingsContainer button{width:100%;padding:12px 15px;border:none;background:#fff;display:flex;align-items:center;justify-content:space-between;gap:10px;color:#000;font-size:16px;cursor:pointer;border-radius:6px;transition:background 0.2s;}
.settingsContainer button:hover{background:#f1f1f1;}
.settingsContainer i{color:black;font-size:18px;}
.settingsContainer input[type="checkbox"]{transform:scale(1.2);cursor:pointer;}
.backArrow{cursor:pointer;font-size:22px;position:absolute;left:0;top:0;}
</style>
</head>
<body>

<!-- CHAT PAGE -->
<div id="chatPage">
  <div class="header">
    <img id="friendPhoto" src="default-profile.png" alt="friend">
    <div class="header-info">
      <h2 id="friendName"></h2>
    </div>
    <div class="header-actions">
      <button id="callBtn"><i class="fa-solid fa-phone"></i></button>
      <button id="menuBtn"><i class="fa-solid fa-ellipsis-vertical"></i></button>
    </div>
    <div class="popup" id="menuPopup">
      <div onclick="openFriendInfo()">View Info</div>
      <div onclick="alert('Muted!')">Mute</div>
      <div onclick="deleteChat()">Delete Chat</div>
      <div onclick="openSettings()">Chat Settings</div>
    </div>
  </div>

  <!-- CHAT SETTINGS MODAL -->
  <div id="settingsModal" style="display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:20px;border-radius:12px;z-index:3000;box-shadow:0 6px 18px rgba(0,0,0,0.2);width:300px;">
    <h3>Chat Settings</h3>
    <div style="margin-top:10px;">
      <label>Theme: 
        <select id="themeSelect" style="margin-left:5px;">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </label>
    </div>
    <div style="margin-top:10px;">
      <label>Chat Bubble: 
        <select id="chatThemeSelect" style="margin-left:5px;">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
          <option value="blue">Blue</option>
          <option value="green">Green</option>
        </select>
      </label>
    </div>
    <div style="margin-top:10px;">
      <label>Font Size: 
        <select id="fontSizeSelect" style="margin-left:5px;">
          <option value="small">Small</option>
          <option value="medium">Medium</option>
          <option value="large">Large</option>
        </select>
      </label>
    </div>
    <button style="margin-top:15px;padding:8px 12px;background:#128C7E;color:white;border:none;border-radius:6px;cursor:pointer;" onclick="closeSettings()">Close</button>
  </div>
  
  <div id="chatBox">
    <div class="msg system">üîí Messages are end-to-end encrypted</div>
  </div>

  <div id="inputArea">
    <div class="input-box">
      <input id="msgInput" placeholder="Type a message..." autocomplete="off">
      <div class="input-buttons">
        <button id="emojiBtn"><i class="fa-solid fa-face-smile"></i></button>
        <button id="plusBtn"><i class="fa-solid fa-paperclip"></i></button>
      </div>
    </div>
    <button id="micBtn"><i class="fa-solid fa-microphone"></i></button>
  </div>
</div>

<!-- Emoji Picker -->
<div id="emojiPicker">
  <span>üòÄ</span><span>üòÇ</span><span>üòç</span><span>üò≠</span>
  <span>üòé</span><span>üò°</span><span>üëç</span><span>üôè</span>
  <span>üî•</span><span>üéâ</span><span>‚ù§Ô∏è</span>
</div>

<!-- ATTACHMENTS -->
<div id="attachPopup">
  <div id="attachGrid">
    <label class="attachItem">
      <i class="fa-solid fa-image"></i>
      <span>Gallery</span>
      <input type="file" id="galleryInput" accept="image/*,video/*">
    </label>
    <label class="attachItem">
      <i class="fa-solid fa-camera"></i>
      <span>Camera</span>
      <input type="file" id="cameraInput" accept="image/*,video/*" capture="environment">
    </label>
    <div class="attachItem" id="sendLocation">
      <i class="fa-solid fa-location-dot"></i>
      <span>Location</span>
    </div>
    <label class="attachItem">
      <i class="fa-solid fa-file"></i>
      <span>Document</span>
      <input type="file" id="documentInput" accept=".pdf,.doc,.docx,.txt">
    </label>
    <div class="attachItem" id="sendContact">
      <i class="fa-solid fa-user"></i>
      <span>Contact</span>
    </div>
    <label class="attachItem">
      <i class="fa-solid fa-microphone"></i>
      <span>Audio</span>
      <input type="file" id="audioInput" accept="audio/*">
    </label>
  </div>
</div>

<!-- FRIEND INFO PAGE -->
<div id="friendInfoPage">
  <div class="friendHeader">
    <i class="fa-solid fa-arrow-left backArrow" onclick="backToChat()"></i>
    <img id="infoFriendPhoto" src="default-profile.png" alt="friend">
    <h2 id="infoFriendName">Friend Name</h2>
    <div class="actionButtons">
      <button id="videoCallBtn"><i class="fa-solid fa-video"></i><span>Video Call</span></button>
      <button id="audioCallBtn"><i class="fa-solid fa-phone"></i><span>Audio Call</span></button>
      <button id="searchBtn"><i class="fa-solid fa-magnifying-glass"></i><span>Search</span></button>
    </div>
  </div>

  <!-- SETTINGS SECTION -->
  <div class="settingsContainer">
    <button><i class="fa-solid fa-lock"></i> End-to-End Encryption</button>
    <button><i class="fa-solid fa-network-wired"></i> Mesh Network Form</button>
    <button><i class="fa-solid fa-paint-roller"></i> Chat Color & Wallpaper</button>
    <button><i class="fa-solid fa-shield"></i> Advanced Chat Privacy</button>
  </div>
  
  <!-- NO GROUPS SECTION -->
  <div class="settingsContainer">
    <div style="display:flex;align-items:center;justify-content:space-between;">
      <span>No groups in common</span>
      <button class="addFriendBtn" id="addFriendBtn" style="background:#128C7E;color:white;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;">+ create group </button>
    </div>
  </div>

 <!-- BLOCK & REPORT SECTION -->
<div class="settingsContainer">
  <div style="display:flex;flex-direction:column;gap:8px;">
    <button class="blockBtn" style="display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:8px;background:#fff;color:#f44336;cursor:pointer;font-weight:bold;">
      <span><i class="fa-solid fa-ban"></i> Block User</span>
    </button>
    <button class="reportBtn" style="display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:8px;background:#fff;color:#ff5722;cursor:pointer;font-weight:bold;">
      <span><i class="fa-solid fa-flag"></i> Report User</span>
    </button>
  </div>
</div>

<script>
// ======== INITIALIZATION ========
let chatBox = document.getElementById('chatBox');
let msgInput = document.getElementById('msgInput');
let micBtn = document.getElementById('micBtn');
let emojiBtn = document.getElementById('emojiBtn');
let emojiPicker = document.getElementById('emojiPicker');
let plusBtn = document.getElementById('plusBtn');
let attachPopup = document.getElementById('attachPopup');
let menuBtn = document.getElementById('menuBtn');
let menuPopup = document.getElementById('menuPopup');
let friendName = document.getElementById('friendName');
let friendPhoto = document.getElementById('friendPhoto');

let chatPage = document.getElementById('chatPage');
let friendInfoPage = document.getElementById('friendInfoPage');
let infoFriendName = document.getElementById('infoFriendName');
let infoFriendPhoto = document.getElementById('infoFriendPhoto');

// Load messages from localStorage
let messages = JSON.parse(localStorage.getItem('messages')) || [];

// ======== DISPLAY FRIEND INFO ========
function loadFriendInfo() {
    friendName.textContent = "Alice";
    friendPhoto.src = "default-profile.png";
    infoFriendName.textContent = "Alice";
    infoFriendPhoto.src = "default-profile.png";
}
loadFriendInfo();

// ======== CHAT RENDER FUNCTION ========
function renderMessages() {
    chatBox.innerHTML = '<div class="msg system">üîí Messages are end-to-end encrypted</div>';
    messages.forEach(msg => {
        let div = document.createElement('div');
        div.className = 'msg ' + (msg.self ? 'self' : '');
        if(msg.type==='text'){
            div.innerHTML = msg.content + `<span class="meta">${msg.time}</span>`;
        } else if(msg.type==='image'){
            let img = document.createElement('img');
            img.src = msg.content;
            img.style.maxWidth = "200px";
            img.style.borderRadius="12px";
            div.appendChild(img);
        } else if(msg.type==='audio'){
            let audio = document.createElement('audio');
            audio.controls = true;
            audio.src = msg.content;
            div.appendChild(audio);
        } else if(msg.type==='system'){
            div.className = 'msg system';
            div.textContent = msg.content;
        }
        chatBox.appendChild(div);
    });
    chatBox.scrollTop = chatBox.scrollHeight;
}
renderMessages();

// ======== SEND MESSAGE ========
function sendMessage(content,type='text'){
    if(!content) return;
    let now = new Date();
    let time = now.getHours().toString().padStart(2,'0') + ":" + now.getMinutes().toString().padStart(2,'0');
    let msg = {content,type,self:true,time};
    messages.push(msg);
    localStorage.setItem('messages',JSON.stringify(messages));
    renderMessages();
    msgInput.value='';
}

// ======== INPUT EVENT ========
msgInput.addEventListener('keydown',e=>{
    if(e.key==='Enter' && !e.shiftKey){
        e.preventDefault();
        sendMessage(msgInput.value,'text');
    }
});

// ======== EMOJI PICKER ========
emojiBtn.addEventListener('click',()=>{
    emojiPicker.style.display = emojiPicker.style.display==='block'?'none':'block';
});
emojiPicker.querySelectorAll('span').forEach(emoji=>{
    emoji.addEventListener('click',()=>{msgInput.value+=emoji.textContent; msgInput.focus();});
});
document.addEventListener('click',e=>{
    if(!emojiBtn.contains(e.target) && !emojiPicker.contains(e.target)){
        emojiPicker.style.display='none';
    }
});

// ======== ATTACHMENTS ========
plusBtn.addEventListener('click',()=>{attachPopup.style.display = attachPopup.style.display==='block'?'none':'block';});

// Gallery
document.getElementById('galleryInput').addEventListener('change',e=>{
    let file = e.target.files[0];
    if(file){
        let reader = new FileReader();
        reader.onload = function(){ sendMessage(reader.result,'image'); }
        reader.readAsDataURL(file);
    }
});
// Camera
document.getElementById('cameraInput').addEventListener('change',e=>{
    let file = e.target.files[0];
    if(file){
        let reader = new FileReader();
        reader.onload = function(){ sendMessage(reader.result,'image'); }
        reader.readAsDataURL(file);
    }
});
// Audio
document.getElementById('audioInput').addEventListener('change',e=>{
    let file = e.target.files[0];
    if(file){
        let reader = new FileReader();
        reader.onload = function(){ sendMessage(reader.result,'audio'); }
        reader.readAsDataURL(file);
    }
});
// Document
document.getElementById('documentInput').addEventListener('change',e=>{
    let file = e.target.files[0];
    if(file){
        sendMessage(file.name,'system');
    }
});
// Location
document.getElementById('sendLocation').addEventListener('click',()=>{
    if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
            sendMessage(`Location: https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`,'system');
        });
    } else alert('Geolocation not supported');
});
// Contact
document.getElementById('sendContact').addEventListener('click',()=>{
    let name = prompt('Enter contact name');
    if(name) sendMessage(`Contact: ${name}`,'system');
});

// ======== MIC RECORDING LIKE WHATSAPP ========
let mediaRecorder, audioChunks=[];
micBtn.addEventListener('mousedown',async ()=>{
    if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia){ alert('Mic not supported'); return; }
    let stream = await navigator.mediaDevices.getUserMedia({audio:true});
    mediaRecorder = new MediaRecorder(stream);
    audioChunks = [];
    mediaRecorder.ondataavailable = e=>{audioChunks.push(e.data);}
    mediaRecorder.onstop = e=>{
        let blob = new Blob(audioChunks,{type:'audio/mp3'});
        let url = URL.createObjectURL(blob);
        sendMessage(url,'audio');
    }
    mediaRecorder.start();
});
micBtn.addEventListener('mouseup',()=>{
    if(mediaRecorder) mediaRecorder.stop();
});

// ======== MENU POPUP ========
menuBtn.addEventListener('click',()=>{menuPopup.style.display=menuPopup.style.display==='block'?'none':'block';});
document.addEventListener('click',e=>{
    if(!menuBtn.contains(e.target) && !menuPopup.contains(e.target)){
        menuPopup.style.display='none';
    }
});

// ======== FRIEND INFO ========
function openFriendInfo(){
    chatPage.style.display='none';
    friendInfoPage.style.display='flex';
}
function backToChat(){
    chatPage.style.display='flex';
    friendInfoPage.style.display='none';
}

// ======== CHAT SETTINGS ========
function openSettings(){document.getElementById('settingsModal').style.display='block';}
function closeSettings(){document.getElementById('settingsModal').style.display='none';}

// ======== DELETE CHAT ========
function deleteChat(){
    if(confirm('Delete all messages?')){
        messages=[];
        localStorage.setItem('messages',JSON.stringify(messages));
        renderMessages();
    }
}

// ======== BLOCK & REPORT ========
document.querySelector('.blockBtn').addEventListener('click',()=>alert('User Blocked!'));
document.querySelector('.reportBtn').addEventListener('click',()=>alert('User Reported!'));

// ======== INITIAL RENDER ========
renderMessages();

</script>
</body>
</html>
