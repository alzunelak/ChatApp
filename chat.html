<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body{margin:0;font-family:'Segoe UI',Arial,sans-serif;background: #000;color: #fff;height:100vh;display:flex;flex-direction:column;}
#chatPage,#friendInfoPage{display:flex;flex-direction:column;flex:1;}
.header{display:flex;align-items:center;justify-content:space-between;background:#000;padding:10px;border-bottom:1px solid #ccc;position:relative;}
.header img{width:50px;height:50px;border-radius:50%;cursor:pointer;object-fit:cover;}
.header-info{flex:1;display:flex;flex-direction:column;margin-left:10px;overflow:hidden;}
.header-info h2{margin:0;font-size:16px;cursor:pointer;}
.header-actions{display:flex;align-items:center;gap:15px;}
.header-actions button{background:none;border:none;cursor:pointer;font-size:20px;color:white;}
#chatBox{flex:1;overflow-y:auto;padding:10px;margin-bottom:100px;display:flex;flex-direction:column;gap:6px;background:#000;color:#fff;}
.msg{max-width:70%;padding:10px 14px;border-radius:18px;background:#000;color:#fff;align-self:flex-start;word-break:break-word;}
.msg.self{background:#000;color:#fff;align-self:flex-end;}
.msg .meta{display:block;margin-top:4px;font-size:10px;color:#ccc;text-align:right;}
.msg.system{background:#000;color:#25d366;align-self:center;text-align:center;}
#inputArea{display:flex;align-items:center;position:fixed;bottom:10px;left:10px;width:calc(100% - 20px);z-index:100;}
.input-box{display:flex;flex:1;background:#000;border-radius:25px;padding:6px 10px;gap:6px;}
.input-box input{flex:1;border:none;outline:none;font-size:14px;background:transparent;}
.input-buttons button{background:transparent;border:none;font-size:20px;cursor:pointer;color:#25d366;}
#micBtn{width:40px;height:40px;border-radius:50%;background:#25d366;color:white;border:none;font-size:18px;display:flex;align-items:center;justify-content:center;margin-left:6px;}
.popup{display:none;position:absolute;top:50px;right:10px;background:#000;border:1px solid #ccc;border-radius:8px;z-index:1000;width:150px;}
.popup div{padding:10px;cursor:pointer;border-bottom:1px solid #25d366;}
.popup div:hover{background:#000;}
#emojiPicker{position:absolute;bottom:60px;right:10px;background:#000;box-shadow: 0 0 5px #25d366;border:1px solid #ccc;padding:10px;display:none;max-height:200px;overflow-y:auto;border-radius:8px;}
#emojiPicker span{font-size:20px;padding:5px;cursor:pointer;}
#emojiPicker span:hover{background:#000;border-radius:5px;}
#attachPopup{display:none;position:absolute;bottom:60px;right:60px;background:#000;border:1px solid #ccc;border-radius:12px;padding:12px;width:270px;box-shadow:0 6px 18px rgba(0,0,0,0.2);z-index:2000;}
#attachGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
.attachItem{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:10px;border-radius:10px;cursor:pointer;background:#000;border:1px solid #25d366;text-align:center;font-size:12px;user-select:none;}
.attachItem:hover{background:#25d366;}
.attachItem i{font-size:20px;color:#25d366;}
.attachItem input{display:none;}
#friendInfoPage{display:none;flex-direction:column;padding:20px;background:#000;}
.friendHeader{text-align:center;margin-bottom:20px;position:relative;}
.friendHeader img{width:120px;height:120px;border-radius:50%;margin-bottom:10px;object-fit:cover;}
.friendHeader h2{margin:0;font-size:22px;margin-bottom:20px;}
.actionButtons{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px;width:100%;}
.actionButtons button{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10px 0;background:#000;color: #fff;border:1px solid #000;box-shadow: 0 4px 8px rgba(37, 211, 102, 0.4);border-radius:8px;cursor:pointer;}
.actionButtons i{font-size:20px;margin-bottom:5px;}
.settingsContainer{display:flex;flex-direction:column;gap:8px;padding:10px;background:#000;color:#fff;border:1px solid #000;box-shadow:0 4px 8px rgba(37,211,102,0.4);border-radius:8px;margin-bottom:15px;}
.settingsContainer button.settingsItem{display:flex;align-items:center;justify-content:space-between;width:100%;padding:12px 15px;border:none;border-radius:6px;background:#000;color:#fff;font-size:16px;cursor:pointer;transition:background 0.2s, box-shadow 0.2s;}
.settingsContainer button.settingsItem:hover{box-shadow:0 0 10px #25d366;}
.addFriendBtn{background:#000;color:#fff;border:1px solid #25d366;box-shadow:0 2px 6px rgba(37,211,102,0.4);border-radius:6px;padding:6px 12px;cursor:pointer;}
.addFriendBtn:hover{box-shadow:0 0 10px #25d366;}
.blockBtn, .reportBtn{background:#000;color:red;border:1px solid #000;box-shadow:0 2px 6px rgba(37,211,102,0.4);border-radius:8px;font-weight:bold;padding:12px;cursor:pointer;}
.blockBtn:hover, .reportBtn:hover{box-shadow:0 0 10px #25d366;}
.settingsContainer i, .addFriendBtn i, .blockBtn i, .reportBtn i{color:red;}
.backArrow{cursor:pointer;font-size:22px;position:absolute;left:0;top:0;}
.settingsItem{display:flex;align-items:center;justify-content:space-between;padding:12px;background:#000;border-radius:8px;cursor:pointer;width:100%;box-sizing:border-box;font-size:16px;border:none;min-height:50px;}
.settingsItem small{font-size:14px;color:#fff;}
.settingsItem label.switch{margin:0;}
.settingsItem:last-child{cursor:default;justify-content:flex-start;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);z-index:4000;align-items:center;justify-content:center;}
.modal-content{background:#000;padding:20px;border-radius:12px;width:300px;box-shadow:0 6px 18px rgba(0,0,0,0.3);}
.option-group{display:flex;flex-direction:column;gap:8px;margin:15px 0;}
.close-btn{background:#000;color:#fff;border:none;padding:10px 15px;border-radius:8px;cursor:pointer;width:100%;font-size:16px;}
.switch{position:relative;display:inline-block;width:50px;height:24px;}
.switch input{opacity:0;width:0;height:0;}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#ccc;transition:.4s;border-radius:24px;}
.slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background:white;transition:.4s;border-radius:50%;}
input:checked + .slider{background:#25d366;}
input:checked + .slider:before{transform:translateX(26px);}
.phoneAnimation{position:relative;display:flex;justify-content:center;align-items:center;margin:20px 0;height:100px;gap:40px;}
.phone{width:50px;height:90px;border:2px solid #128C7E;border-radius:10px;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;background:#e6f7f1;animation:bounce 1.5s infinite alternate;}
.phone .screen{width:90%;height:80%;background:#fff;border-radius:5px;}
@keyframes bounce{0%{transform:translateY(0);}50%{transform:translateY(-8px);}100%{transform:translateY(0);}}
.checkMark{position:absolute;font-size:30px;color:#25D366;opacity:0;transform:scale(0);animation:appear 2s forwards 1.5s;}
@keyframes appear{0%{opacity:0;transform:scale(0);}50%{opacity:1;transform:scale(1.2);}100%{opacity:1;transform:scale(1);}}
.encryptionContent{text-align:center;}
</style>
</head>
<body>

<!-- CHAT PAGE -->
<div id="chatPage">
  <div class="header">
    <img id="friendPhoto" src="default-profile.png" alt="friend">
    <div class="header-info">
      <h2 id="friendName"></h2>
    </div>
    <div class="header-actions">
      <button id="callBtn"><i class="fa-solid fa-phone"></i></button>
      <button id="menuBtn"><i class="fa-solid fa-ellipsis-vertical"></i></button>
    </div>
    <div class="popup" id="menuPopup">
      <div onclick="openFriendInfo()">View Info</div>
      <div onclick="alert('Muted!')">Mute</div>
      <div onclick="deleteChat()">Delete Chat</div>
      <div onclick="openSettings()">Chat Settings</div>
    </div>
  </div>

  <div id="chatBox">
    <div class="msg system">üîí Messages are end-to-end encrypted</div>
  </div>

  <div id="inputArea">
    <div class="input-box">
      <input id="msgInput" placeholder="Type a message..." autocomplete="off">
      <div class="input-buttons">
        <button id="emojiBtn"><i class="fa-solid fa-face-smile"></i></button>
        <button id="plusBtn"><i class="fa-solid fa-paperclip"></i></button>
      </div>
    </div>
    <button id="micBtn"><i class="fa-solid fa-microphone"></i></button>
  </div>
</div>

<!-- Emoji Picker -->
<div id="emojiPicker">
  <span>üòÄ</span><span>üòÇ</span><span>üòç</span><span>üò≠</span>
  <span>üòé</span><span>üò°</span><span>üëç</span><span>üôè</span>
  <span>üî•</span><span>üéâ</span><span>‚ù§Ô∏è</span>
</div>

<!-- ATTACHMENTS -->
<div id="attachPopup">
  <div id="attachGrid">
    <label class="attachItem">
      <i class="fa-solid fa-image"></i>
      <span>Gallery</span>
      <input type="file" id="galleryInput" accept="image/*,video/*">
    </label>
    <label class="attachItem">
      <i class="fa-solid fa-camera"></i>
      <span>Camera</span>
      <input type="file" id="cameraInput" accept="image/*,video/*" capture="environment">
    </label>
    <div class="attachItem"><i class="fa-solid fa-location-dot"></i><span>Location</span></div>
    <div class="attachItem"><i class="fa-solid fa-file"></i><span>Document</span></div>
  </div>
</div>

<!-- FRIEND INFO PAGE -->
<div id="friendInfoPage">
  <div class="friendHeader">
    <i class="fa-solid fa-arrow-left backArrow" onclick="backToChat()"></i>
    <img id="infoPhoto" src="default-profile.png" alt="friend">
    <h2 id="infoName"></h2>
  </div>

  <div class="actionButtons">
    <button class="addFriendBtn"><i class="fa-solid fa-user-plus"></i>Add Friend</button>
    <button class="blockBtn"><i class="fa-solid fa-ban"></i>Block</button>
    <button class="reportBtn"><i class="fa-solid fa-flag"></i>Report</button>
  </div>
</div>

<!-- BLOCK / REPORT MODAL -->
<div class="modal" id="blockReportModal">
  <div class="modal-content">
    <p id="blockReportText">Are you sure?</p>
    <div class="option-group">
      <button class="close-btn" id="cancelBlockReport">Cancel</button>
      <button class="close-btn" id="confirmBlock">Confirm</button>
    </div>
  </div>
</div>

<!-- REPORT CONFIRMATION MODAL -->
<div class="modal" id="ReportModal">
  <div class="modal-content encryptionContent">
    <div class="phoneAnimation">
      <div class="phone"><div class="screen"></div></div>
      <i class="fa-solid fa-check checkMark"></i>
    </div>
    <p>Report Sent!</p>
    <button class="close-btn" id="confirmReport">OK</button>
  </div>
</div>

<script>
// ===== MENU POPUP =====
const menuBtn = document.getElementById("menuBtn");
const menuPopup = document.getElementById("menuPopup");
menuBtn.onclick = () => menuPopup.style.display = menuPopup.style.display === "flex" ? "none" : "flex";

// ===== FRIEND INFO =====
const friendData = { name: "John Doe", photo: "default-profile.png" };
function openFriendInfo() {
  document.getElementById("chatPage").style.display = "none";
  document.getElementById("friendInfoPage").style.display = "flex";
  document.getElementById("infoName").textContent = friendData.name;
  document.getElementById("infoPhoto").src = friendData.photo;
}
function backToChat() {
  document.getElementById("friendInfoPage").style.display = "none";
  document.getElementById("chatPage").style.display = "flex";
}

// ===== BLOCK & REPORT MODALS =====
document.querySelector(".blockBtn").onclick = () => {
  document.getElementById("blockReportModal").style.display = "flex";
  document.getElementById("blockReportModal").dataset.type = "block";
  document.getElementById("blockReportText").textContent = "Are you sure you want to block this user?";
};

document.querySelector(".reportBtn").onclick = () => {
  document.getElementById("blockReportModal").style.display = "flex";
  document.getElementById("blockReportModal").dataset.type = "report";
  document.getElementById("blockReportText").textContent =
    "The last 5 messages in this chat will be sent to report. This person won't know you reported.";
};

document.getElementById("cancelBlockReport").onclick = () => {
  document.getElementById("blockReportModal").style.display = "none";
};

document.getElementById("confirmBlock").onclick = () => {
  const type = document.getElementById("blockReportModal").dataset.type;
  if (type === "block") {
    let blocked = JSON.parse(localStorage.getItem("blockedUsers") || "[]");
    let friends = JSON.parse(localStorage.getItem("friends") || "[]");
    if (!blocked.includes(friendData.name)) blocked.push(friendData.name);
    localStorage.setItem("blockedUsers", JSON.stringify(blocked));
    friends = friends.filter(f => f.name !== friendData.name);
    localStorage.setItem("friends", JSON.stringify(friends));
    document.getElementById("blockReportModal").style.display = "none";
    setTimeout(() => { backToChat(); }, 200);
  } else if (type === "report") {
    document.getElementById("blockReportModal").style.display = "none";
    const reportConfirmModal = document.getElementById("ReportModal");
    reportConfirmModal.style.display = "flex";
    setTimeout(() => { reportConfirmModal.style.display = "none"; }, 1500);
  }
};

document.getElementById("confirmReport").onclick = () => {
  document.getElementById("ReportModal").style.display = "none";
};

// ===== EMOJI PICKER =====
const emojiBtn = document.getElementById("emojiBtn");
const emojiPicker = document.getElementById("emojiPicker");
emojiBtn.onclick = () => emojiPicker.style.display = emojiPicker.style.display === "flex" ? "none" : "flex";
emojiPicker.querySelectorAll("span").forEach(e => e.onclick = () => {
  document.getElementById("msgInput").value += e.textContent;
  emojiPicker.style.display = "none";
});

// ===== ATTACHMENT POPUP =====
const plusBtn = document.getElementById("plusBtn");
const attachPopup = document.getElementById("attachPopup");
plusBtn.onclick = () => attachPopup.style.display = attachPopup.style.display === "flex" ? "none" : "flex";

</script>
</body>
</html>
